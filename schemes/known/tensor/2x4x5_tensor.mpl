A:=Matrix(2, 4, [[A_1_1,A_1_2,A_1_3,A_1_4],[A_2_1,A_2_2,A_2_3,A_2_4]]):
B:=Matrix(4, 5, [[B_1_1,B_1_2,B_1_3,B_1_4,B_1_5],[B_2_1,B_2_2,B_2_3,B_2_4,B_2_5],[B_3_1,B_3_2,B_3_3,B_3_4,B_3_5],[B_4_1,B_4_2,B_4_3,B_4_4,B_4_5]]):
C:=Matrix(5, 2, [[C_1_1,C_1_2],[C_2_1,C_2_2],[C_3_1,C_3_2],[C_4_1,C_4_2],[C_5_1,C_5_2]]):
Tensor:=TriadSet([Triad([Matrix(2, 4, [[0,1/2,0,-1/2],[0,-1/2,0,1/2]]), Matrix(4, 5, [[1/2,1/2,1/2,-1/2,0],[1/2,1/2,-1/2,1/2,0],[0,0,0,0,-1],[0,-1,1,0,-1]]), Matrix(5, 2, [[0,0],[0,-1],[0,0],[0,0],[0,-1/2]])]), Triad([Matrix(2, 4, [[1/2,-1/2,0,0],[1/2,-1/2,0,0]]), Matrix(4, 5, [[0,0,0,0,0],[-2,0,0,0,0],[0,0,0,0,0],[0,0,0,0,0]]), Matrix(5, 2, [[1/2,1/2],[1/2,1/2],[0,0],[0,0],[0,0]])]), Triad([Matrix(2, 4, [[0,0,-1/2,1/2],[0,0,1/2,-1/2]]), Matrix(4, 5, [[0,0,0,0,0],[0,0,0,0,0],[0,0,0,0,0],[0,0,0,2,0]]), Matrix(5, 2, [[1/2,-1/2],[0,0],[0,0],[1/2,-1/2],[0,0]])]), Triad([Matrix(2, 4, [[1/2,1/2,0,-1],[1/2,-1/2,0,0]]), Matrix(4, 5, [[0,1,0,0,1],[1,0,0,0,-1],[-1/2,1/2,-1/2,1/2,0],[-1/2,-1/2,1/2,1/2,0]]), Matrix(5, 2, [[1/2,-1/2],[1/2,1/2],[0,0],[0,0],[0,1/2]])]), Triad([Matrix(2, 4, [[0,0,1/2,1/2],[0,0,0,0]]), Matrix(4, 5, [[0,0,0,0,0],[0,0,0,0,0],[0,2,0,0,0],[0,0,0,0,0]]), Matrix(5, 2, [[0,0],[1,0],[1,0],[0,0],[0,0]])]), Triad([Matrix(2, 4, [[0,1/2,-1/2,0],[0,-1/2,1/2,0]]), Matrix(4, 5, [[-1/2,1/2,-1/2,1/2,-1],[-1/2,1/2,-1/2,1/2,-1],[1/2,-1/2,1/2,-1/2,1],[1/2,-1/2,1/2,-1/2,1]]), Matrix(5, 2, [[0,0],[0,0],[-1,0],[0,0],[-1/2,0]])]), Triad([Matrix(2, 4, [[1/2,-1/2,0,0],[-1/2,1/2,0,0]]), Matrix(4, 5, [[0,2,0,0,0],[0,0,0,0,0],[0,0,0,0,0],[0,0,0,0,0]]), Matrix(5, 2, [[1/2,-1/2],[1/2,-1/2],[0,0],[0,0],[0,0]])]), Triad([Matrix(2, 4, [[0,0,0,0],[0,-1/2,1/2,0]]), Matrix(4, 5, [[0,0,-1,0,0],[0,0,1,0,0],[0,0,-1,0,0],[0,0,1,0,0]]), Matrix(5, 2, [[0,0],[0,0],[-1,-1],[0,0],[-1/2,-1/2]])]), Triad([Matrix(2, 4, [[-1/2,0,0,-1/2],[-1/2,0,0,-1/2]]), Matrix(4, 5, [[1,0,0,0,0],[1,0,0,0,0],[1,0,0,0,0],[1,0,0,0,0]]), Matrix(5, 2, [[0,-1],[0,0],[0,0],[0,0],[0,-1/2]])]), Triad([Matrix(2, 4, [[-1/2,-1/2,0,0],[0,0,0,0]]), Matrix(4, 5, [[0,0,0,0,0],[0,0,0,2,0],[0,0,0,0,0],[0,0,0,0,0]]), Matrix(5, 2, [[0,0],[0,0],[-1,0],[-1,0],[0,0]])]), Triad([Matrix(2, 4, [[0,0,0,0],[0,1/2,1/2,0]]), Matrix(4, 5, [[0,0,1,0,0],[0,0,-1,0,0],[0,0,-1,0,0],[0,0,1,0,0]]), Matrix(5, 2, [[0,0],[0,0],[-1,-1],[0,0],[1/2,1/2]])]), Triad([Matrix(2, 4, [[-1/2,0,1/2,0],[1/2,0,-1/2,0]]), Matrix(4, 5, [[0,0,1,-1,-1],[0,0,0,0,-1],[1/2,1/2,-1/2,1/2,0],[1/2,-1/2,1/2,1/2,0]]), Matrix(5, 2, [[0,0],[0,0],[0,0],[0,-1],[0,-1/2]])]), Triad([Matrix(2, 4, [[0,-1/2,-1/2,0],[0,1/2,1/2,0]]), Matrix(4, 5, [[1/2,-1/2,1/2,-1/2,-1],[1/2,-1/2,1/2,-1/2,-1],[1/2,-1/2,1/2,-1/2,-1],[1/2,-1/2,1/2,-1/2,-1]]), Matrix(5, 2, [[0,0],[0,0],[-1,0],[0,0],[1/2,0]])]), Triad([Matrix(2, 4, [[0,1/2,0,-1/2],[0,-1/2,-1/2,0]]), Matrix(4, 5, [[-1/2,1/2,-1/2,1/2,0],[-1/2,1/2,1/2,-1/2,0],[0,1,0,0,1],[0,0,-1,0,1]]), Matrix(5, 2, [[0,0],[0,-1],[1,0],[0,0],[-1/2,-1/2]])]), Triad([Matrix(2, 4, [[1/2,0,1/2,0],[0,0,0,0]]), Matrix(4, 5, [[1/2,-1/2,-1/2,-1/2,0],[1/2,-1/2,1/2,1/2,0],[1,0,0,-1,1],[0,0,0,0,-1]]), Matrix(5, 2, [[0,0],[0,0],[0,0],[-1,-1],[1/2,1/2]])]), Triad([Matrix(2, 4, [[0,1/2,0,1/2],[0,0,0,0]]), Matrix(4, 5, [[0,0,0,0,-1],[1,-1,0,0,1],[1/2,1/2,1/2,-1/2,0],[1/2,-1/2,-1/2,-1/2,0]]), Matrix(5, 2, [[0,0],[-1,-1],[0,0],[0,0],[1/2,1/2]])]), Triad([Matrix(2, 4, [[1/2,0,1/2,0],[0,1/2,-1/2,0]]), Matrix(4, 5, [[0,0,-1,0,-1],[0,0,0,1,-1],[1/2,1/2,-1/2,-1/2,0],[1/2,-1/2,1/2,-1/2,0]]), Matrix(5, 2, [[0,0],[0,0],[-1,0],[0,1],[-1/2,-1/2]])]), Triad([Matrix(2, 4, [[-1,0,-1/2,-1/2],[0,0,1/2,-1/2]]), Matrix(4, 5, [[-1/2,1/2,1/2,-1/2,0],[-1/2,1/2,-1/2,1/2,0],[-1,0,0,0,-1],[0,0,0,-1,1]]), Matrix(5, 2, [[1/2,-1/2],[0,0],[0,0],[1/2,1/2],[0,-1/2]])]), Triad([Matrix(2, 4, [[-1/2,0,1/2,0],[0,-1/2,-1/2,0]]), Matrix(4, 5, [[0,0,1,0,-1],[0,0,0,-1,-1],[1/2,1/2,-1/2,-1/2,0],[1/2,-1/2,1/2,-1/2,0]]), Matrix(5, 2, [[0,0],[0,0],[-1,0],[0,1],[1/2,1/2]])]), Triad([Matrix(2, 4, [[0,-1/2,0,-1/2],[0,1/2,0,1/2]]), Matrix(4, 5, [[1/2,1/2,1/2,-1/2,0],[1/2,1/2,-1/2,1/2,0],[0,0,0,0,-1],[0,1,-1,0,-1]]), Matrix(5, 2, [[0,0],[0,1],[0,0],[0,0],[0,-1/2]])]), Triad([Matrix(2, 4, [[-1/2,0,0,-1/2],[0,0,0,0]]), Matrix(4, 5, [[-1/2,1/2,-1/2,1/2,-1],[1/2,-1/2,1/2,-1/2,1],[1/2,-1/2,1/2,-1/2,1],[-1/2,1/2,-1/2,1/2,-1]]), Matrix(5, 2, [[1,-1],[0,0],[0,0],[0,0],[1/2,-1/2]])]), Triad([Matrix(2, 4, [[0,0,-1/2,1/2],[0,0,-1/2,1/2]]), Matrix(4, 5, [[0,0,0,0,0],[0,0,0,0,0],[2,0,0,0,0],[0,0,0,0,0]]), Matrix(5, 2, [[-1/2,-1/2],[0,0],[0,0],[-1/2,-1/2],[0,0]])]), Triad([Matrix(2, 4, [[1/2,0,-1/2,0],[0,0,0,0]]), Matrix(4, 5, [[-1/2,1/2,1/2,1/2,0],[-1/2,1/2,-1/2,-1/2,0],[1,0,0,-1,-1],[0,0,0,0,1]]), Matrix(5, 2, [[0,0],[0,0],[0,0],[1,1],[1/2,1/2]])]), Triad([Matrix(2, 4, [[0,1/2,0,1/2],[0,-1/2,1/2,0]]), Matrix(4, 5, [[-1/2,1/2,-1/2,1/2,0],[-1/2,1/2,1/2,-1/2,0],[0,-1,0,0,1],[0,0,1,0,1]]), Matrix(5, 2, [[0,0],[0,-1],[1,0],[0,0],[1/2,1/2]])]), Triad([Matrix(2, 4, [[-1/2,-1/2,0,-1],[-1/2,1/2,0,0]]), Matrix(4, 5, [[0,-1,0,0,1],[-1,0,0,0,-1],[-1/2,1/2,-1/2,1/2,0],[-1/2,-1/2,1/2,1/2,0]]), Matrix(5, 2, [[1/2,-1/2],[1/2,1/2],[0,0],[0,0],[0,-1/2]])]), Triad([Matrix(2, 4, [[1/2,0,1/2,0],[-1/2,0,-1/2,0]]), Matrix(4, 5, [[0,0,1,-1,1],[0,0,0,0,1],[-1/2,-1/2,1/2,-1/2,0],[-1/2,1/2,-1/2,-1/2,0]]), Matrix(5, 2, [[0,0],[0,0],[0,0],[0,1],[0,-1/2]])]), Triad([Matrix(2, 4, [[-1,0,1/2,1/2],[0,0,-1/2,1/2]]), Matrix(4, 5, [[1/2,-1/2,-1/2,1/2,0],[1/2,-1/2,1/2,-1/2,0],[-1,0,0,0,1],[0,0,0,-1,-1]]), Matrix(5, 2, [[-1/2,1/2],[0,0],[0,0],[-1/2,-1/2],[0,-1/2]])]), Triad([Matrix(2, 4, [[0,0,0,0],[1/2,1/2,0,0]]), Matrix(4, 5, [[0,0,-2,0,0],[0,0,0,0,0],[0,0,0,0,0],[0,0,0,0,0]]), Matrix(5, 2, [[0,0],[0,0],[0,-1],[0,-1],[0,0]])]), Triad([Matrix(2, 4, [[1/2,0,0,-1/2],[1/2,0,0,-1/2]]), Matrix(4, 5, [[-1,0,0,0,0],[-1,0,0,0,0],[1,0,0,0,0],[1,0,0,0,0]]), Matrix(5, 2, [[0,-1],[0,0],[0,0],[0,0],[0,1/2]])]), Triad([Matrix(2, 4, [[0,0,0,0],[0,0,-1/2,-1/2]]), Matrix(4, 5, [[0,0,0,0,0],[0,0,0,0,0],[0,0,0,0,0],[0,0,2,0,0]]), Matrix(5, 2, [[0,0],[0,-1],[0,-1],[0,0],[0,0]])]), Triad([Matrix(2, 4, [[1/2,0,0,-1/2],[0,0,0,0]]), Matrix(4, 5, [[1/2,-1/2,1/2,-1/2,-1],[-1/2,1/2,-1/2,1/2,1],[1/2,-1/2,1/2,-1/2,-1],[-1/2,1/2,-1/2,1/2,1]]), Matrix(5, 2, [[1,-1],[0,0],[0,0],[0,0],[-1/2,1/2]])]), Triad([Matrix(2, 4, [[0,1/2,0,-1/2],[0,0,0,0]]), Matrix(4, 5, [[0,0,0,0,-1],[-1,1,0,0,1],[1/2,1/2,1/2,-1/2,0],[1/2,-1/2,-1/2,-1/2,0]]), Matrix(5, 2, [[0,0],[1,1],[0,0],[0,0],[1/2,1/2]])])]):
map(expand,A.B-add(LinearAlgebra:-Trace(LinearAlgebra:-Transpose(op([1,i,1,1],Tensor)).A)*LinearAlgebra:-Trace(LinearAlgebra:-Transpose(op([1,i,1,2],Tensor)).B)*LinearAlgebra:-Transpose(op([1,i,1,3],Tensor)),i=1..32));
